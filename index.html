<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ö–ª–∏–∫–µ—Ä v3</title>
<style>
    body { font-family: Arial, sans-serif; background: #f0f0f0; text-align: center; padding: 20px; }
    #balance, #multiplier, #achievements, #eventMsg { font-size: 20px; margin: 10px 0; }
    button { padding: 10px 20px; font-size: 16px; margin: 5px; cursor: pointer; }
    #upgrades { margin-top: 20px; }
    .upgrade { margin-bottom: 10px; }
    .popup { position: absolute; color: green; font-weight: bold; animation: floatUp 1s forwards; pointer-events: none; }
    @keyframes floatUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-30px); } }
    canvas { background: #fff; border: 1px solid #ccc; margin-top: 20px; }
</style>
</head>
<body>

<h1>–ö–ª–∏–∫–µ—Ä v3</h1>
<div id="balance">üí∞ –î–µ–Ω—å–≥–∏: 0</div>
<div id="multiplier">–ú–Ω–æ–∂–∏—Ç–µ–ª—å: √ó1</div>
<div id="eventMsg"></div>
<button id="clickBtn">–ö–ª–∏–∫!</button>

<div id="upgrades">
    <h2>–ê–ø–≥—Ä–µ–π–¥—ã</h2>
    <div class="upgrade">
        <button id="upgradeClickBtn">–£–≤–µ–ª–∏—á–∏—Ç—å –¥–æ—Ö–æ–¥ –∑–∞ –∫–ª–∏–∫ (100$)</button>
        <span id="upgradeClickLvl">–£—Ä–æ–≤–µ–Ω—å: 0</span>
    </div>
    <div class="upgrade">
        <button id="autoClickBtn">–ö—É–ø–∏—Ç—å –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä (500$)</button>
        <span id="autoClickLvl">–£—Ä–æ–≤–µ–Ω—å: 0</span>
    </div>
    <div class="upgrade">
        <button id="bonusBtn">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å √ó2 –¥–æ—Ö–æ–¥–∞ (1000$)</button>
        <span id="bonusTimer">–í—Ä–µ–º—è: 0</span>
    </div>
</div>

<div id="achievements"><h3>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è:</h3><ul id="achList"></ul></div>
<canvas id="chart" width="300" height="150"></canvas>

<script>
// --- –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ---
let balance = 0;
let totalClicks = 0;
let baseClickValue = 1;
let clickMultiplier = 1;
let bonusMultiplier = 1;

let upgrades = {
    click: { level: 0, baseCost: 100 },
    autoclick: { level: 0, baseCost: 500, value: 1 },
    bonus: { active: false, timer: 0, cost: 1000, duration: 30 }
};

let achievements = [
    { name: "100 –∫–ª–∏–∫–æ–≤", condition: () => totalClicks >= 100, unlocked: false },
    { name: "1000 –¥–µ–Ω–µ–≥", condition: () => balance >= 1000, unlocked: false },
    { name: "5000 –¥–µ–Ω–µ–≥", condition: () => balance >= 5000, unlocked: false }
];

let chartData = [];
const eventMsgEl = document.getElementById("eventMsg");

// --- DOM —ç–ª–µ–º–µ–Ω—Ç—ã ---
const balanceEl = document.getElementById("balance");
const multiplierEl = document.getElementById("multiplier");
const clickBtn = document.getElementById("clickBtn");
const upgradeClickBtn = document.getElementById("upgradeClickBtn");
const upgradeClickLvl = document.getElementById("upgradeClickLvl");
const autoClickBtn = document.getElementById("autoClickBtn");
const autoClickLvl = document.getElementById("autoClickLvl");
const bonusBtn = document.getElementById("bonusBtn");
const bonusTimerEl = document.getElementById("bonusTimer");
const achListEl = document.getElementById("achList");
const chart = document.getElementById("chart");
const ctx = chart.getContext("2d");

// --- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ ---
function updateUI() {
    balanceEl.textContent = `üí∞ –î–µ–Ω—å–≥–∏: ${Math.floor(balance)}`;
    multiplierEl.textContent = `–ú–Ω–æ–∂–∏—Ç–µ–ª—å: √ó${(clickMultiplier * bonusMultiplier).toFixed(1)}`;
    upgradeClickLvl.textContent = `–£—Ä–æ–≤–µ–Ω—å: ${upgrades.click.level}`;
    autoClickLvl.textContent = `–£—Ä–æ–≤–µ–Ω—å: ${upgrades.autoclick.level}`;
    upgradeClickBtn.textContent = `–£–≤–µ–ª–∏—á–∏—Ç—å –¥–æ—Ö–æ–¥ –∑–∞ –∫–ª–∏–∫ (${Math.floor(upgrades.click.baseCost * Math.pow(1.15, upgrades.click.level))}$)`;
    autoClickBtn.textContent = `–ö—É–ø–∏—Ç—å –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä (${Math.floor(upgrades.autoclick.baseCost * Math.pow(1.15, upgrades.autoclick.level))}$)`;
    bonusBtn.textContent = upgrades.bonus.active ? `√ó2 –∞–∫—Ç–∏–≤–µ–Ω!` : `–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å √ó2 –¥–æ—Ö–æ–¥–∞ (${upgrades.bonus.cost}$)`;
    bonusTimerEl.textContent = `–í—Ä–µ–º—è: ${upgrades.bonus.timer}`;
}

// --- –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ ---
clickBtn.addEventListener("click", () => {
    let gain = baseClickValue * clickMultiplier * bonusMultiplier;
    balance += gain;
    totalClicks++;

    // –ü–æ–ø–∞–ø —á–∏—Å–ª–∞
    const popup = document.createElement("div");
    popup.className = "popup";
    popup.style.left = (clickBtn.offsetLeft + Math.random() * 50) + "px";
    popup.style.top = (clickBtn.offsetTop - 20) + "px";
    popup.textContent = `+${gain.toFixed(1)}`;
    document.body.appendChild(popup);
    setTimeout(() => popup.remove(), 1000);

    checkAchievements();
    updateUI();
});

// --- –ü–æ–∫—É–ø–∫–∞ –∞–ø–≥—Ä–µ–π–¥–∞ –∫–ª–∏–∫–∞ ---
upgradeClickBtn.addEventListener("click", () => {
    let cost = upgrades.click.baseCost * Math.pow(1.15, upgrades.click.level);
    if(balance >= cost){
        balance -= cost;
        upgrades.click.level++;
        clickMultiplier += 1;
        updateUI();
    }
});

// --- –ü–æ–∫—É–ø–∫–∞ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä–∞ ---
autoClickBtn.addEventListener("click", () => {
    let cost = upgrades.autoclick.baseCost * Math.pow(1.15, upgrades.autoclick.level);
    if(balance >= cost){
        balance -= cost;
        upgrades.autoclick.level++;
        updateUI();
    }
});

// --- –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –±–æ–Ω—É—Å ---
bonusBtn.addEventListener("click", () => {
    if(!upgrades.bonus.active && balance >= upgrades.bonus.cost){
        balance -= upgrades.bonus.cost;
        upgrades.bonus.active = true;
        upgrades.bonus.timer = upgrades.bonus.duration;
        bonusMultiplier = 2;
    }
});

// --- –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ + –±–æ–Ω—É—Å —Ç–∞–π–º–µ—Ä + —Å–æ–±—ã—Ç–∏—è ---
setInterval(() => {
    // –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥
    balance += upgrades.autoclick.level * upgrades.autoclick.value * bonusMultiplier;

    // –¢–∞–π–º–µ—Ä –±–æ–Ω—É—Å–∞
    if(upgrades.bonus.active){
        upgrades.bonus.timer--;
        if(upgrades.bonus.timer <= 0){
            upgrades.bonus.active = false;
            bonusMultiplier = 1;
            upgrades.bonus.timer = 0;
        }
    }

    // –†–∞–Ω–¥–æ–º–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
    if(Math.random() < 0.03){ // ~3% —à–∞–Ω—Å –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
        triggerRandomEvent();
    }

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
    chartData.push({ money: balance, clicks: totalClicks });
    if(chartData.length > 30) chartData.shift();

    drawChart();
    updateUI();
}, 1000);

// --- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è ---
function checkAchievements() {
    achievements.forEach(a => {
        if(!a.unlocked && a.condition()){
            a.unlocked = true;
            const li = document.createElement("li");
            li.textContent = a.name;
            achListEl.appendChild(li);
            showEventMessage(`üéâ –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: ${a.name}`);
        }
    });
}

// --- –°–æ–±—ã—Ç–∏—è ---
function triggerRandomEvent() {
    const events = [
        { text: "+50$!", effect: () => balance += 50 },
        { text: "√ó2 –¥–æ—Ö–æ–¥–∞ 15 —Å–µ–∫!", effect: () => { upgrades.bonus.active = true; upgrades.bonus.timer = 15; bonusMultiplier = 2; } },
        { text: "–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä!", effect: () => upgrades.autoclick.level++ }
    ];
    const e = events[Math.floor(Math.random()*events.length)];
    e.effect();
    showEventMessage(`‚ö° –°–æ–±—ã—Ç–∏–µ: ${e.text}`);
}

// --- –ü–æ–∫–∞–∑ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è ---
function showEventMessage(msg){
    eventMsgEl.textContent = msg;
    setTimeout(() => { eventMsgEl.textContent = ""; }, 5000);
}

// --- –ì—Ä–∞—Ñ–∏–∫ ---
function drawChart() {
    ctx.clearRect(0,0,chart.width, chart.height);
    // –î–µ–Ω—å–≥–∏
    ctx.strokeStyle = "blue";
    ctx.beginPath();
    chartData.forEach((d,i) => {
        let x = i * (chart.width / chartData.length);
        let y = chart.height - (d.money / (Math.max(...chartData.map(c=>c.money),1)) * chart.height);
        if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
    });
    ctx.stroke();
    // –ö–ª–∏–∫–∏
    ctx.strokeStyle = "red";
    ctx.beginPath();
    chartData.forEach((d,i) => {
        let x = i * (chart.width / chartData.length);
        let y = chart.height - (d.clicks / (Math.max(...chartData.map(c=>c.clicks),1)) * chart.height);
        if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
    });
    ctx.stroke();
}

// --- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ ---
function saveGame() {
    localStorage.setItem("balance", balance);
    localStorage.setItem("totalClicks", totalClicks);
    localStorage.setItem("upgrades", JSON.stringify(upgrades));
    localStorage.setItem("achievements", JSON.stringify(achievements));
}

function loadGame() {
    if(localStorage.getItem("balance")) balance = parseFloat(localStorage.getItem("balance"));
    if(localStorage.getItem("totalClicks")) totalClicks = parseInt(localStorage.getItem("totalClicks"));
    if(localStorage.getItem("upgrades")) upgrades = JSON.parse(localStorage.getItem("upgrades"));
    if(localStorage.getItem("achievements")) achievements = JSON.parse(localStorage.getItem("achievements"));
    updateUI();
}

window.addEventListener("beforeunload", saveGame);
loadGame();
</script>

</body>
</html>
















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































