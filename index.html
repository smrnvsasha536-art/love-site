<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üé∞ Slot 5x3 Ultimate PRO</title>
<style>
body{margin:0;background:radial-gradient(circle,#111,#000);font-family:Arial,sans-serif;color:#fff;text-align:center;}
.container{max-width:520px;margin:auto;padding:10px;}
.slots{display:grid;grid-template-columns:repeat(5,1fr);grid-template-rows:repeat(3,80px);gap:6px;margin:15px 0;}
.slot{background:linear-gradient(#444,#222);border-radius:14px;font-size:32px;display:flex;align-items:center;justify-content:center;box-shadow:inset 0 0 10px #000;transition:transform .15s;}
.spin-anim{animation:spin .3s linear infinite;}
@keyframes spin{0%{transform:translateY(-20px)}100%{transform:translateY(20px)}}
button{padding:12px 20px;border:none;border-radius:12px;font-size:16px;background:#e74c3c;color:#fff;margin:5px;}
.result{min-height:26px;margin-top:8px}
.history{font-size:12px;opacity:.7;margin-top:6px;text-align:left;max-height:80px;overflow:auto;}
.chest{display:inline-block;width:80px;height:80px;background:#aa8800;margin:6px;border-radius:10px;line-height:80px;font-size:32px;cursor:pointer;}
</style>
</head>
<body>

<div class="container">
  <h2>üé∞ Slot 5x3 Ultimate PRO</h2>
  <div>–ë–∞–ª–∞–Ω—Å: <b id="balance">15000</b></div>
  <div class="slots" id="slots"></div>
  <button onclick="spin()">SPIN</button>
  <div class="result" id="result"></div>
  <small>–õ–∏–Ω–∏–∏: 5 | Scatter ‚≠ê = 5 FS | Wild üß≤</small>
  <div class="history" id="history"></div>
  <div id="bonusArea"></div>
</div>

<script>
// ===== –ù–∞—Å—Ç—Ä–æ–π–∫–∏ =====
let balance=15000;
const bet=20;
let freeSpins=0;
let totalBets=0, totalWins=0;
const history=[];
const symbols=[
  {s:'üçí', w:30, pay:{3:10,4:20,5:40}},
  {s:'üçã', w:25, pay:{3:12,4:25,5:50}},
  {s:'üçâ', w:20, pay:{3:15,4:30,5:70}},
  {s:'7Ô∏è‚É£', w:8,  pay:{3:50,4:150,5:500}},
  {s:'‚≠ê',  w:5,  scatter:true},
  {s:'üß≤', w:12, pay:{3:20,4:50,5:200}, wild:true}
];

const lines=[
  [[0,0],[0,1],[0,2],[0,3],[0,4]],
  [[1,0],[1,1],[1,2],[1,3],[1,4]],
  [[2,0],[2,1],[2,2],[2,3],[2,4]],
  [[0,0],[1,1],[2,2],[1,3],[0,4]],
  [[2,0],[1,1],[0,2],[1,3],[2,4]]
];

const slotsEl=document.getElementById('slots');
const balanceEl=document.getElementById('balance');
const resultEl=document.getElementById('result');
const historyEl=document.getElementById('history');
const bonusEl=document.getElementById('bonusArea');

// ===== –ü–æ–ª–µ =====
let grid=[];
for(let r=0;r<3;r++){
  grid[r]=[];
  for(let c=0;c<5;c++){
    let d=document.createElement('div');
    d.className='slot';
    d.textContent='‚ùî';
    slotsEl.appendChild(d);
    grid[r][c]=d;
  }
}

// ===== RNG —Å –≤–µ—Å–∞–º–∏ =====
function randSymbol(){
  let pool=[];
  symbols.forEach(o=>{
    for(let i=0;i<o.w;i++) pool.push(o);
  });
  return pool[Math.floor(Math.random()*pool.length)];
}

// ===== –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∑–≤—É–∫ / –≤–∏–±—Ä–∞—Ü–∏—é =====
function playSound(url){let a=new Audio(url);a.play();}
function vibrate(ms){if(navigator.vibrate)navigator.vibrate(ms);}

// ===== SPIN =====
function spin(){
  const cost = bet*lines.length;
  if(freeSpins<=0 && balance<cost){
    resultEl.textContent='‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤';
    return;
  }

  if(freeSpins<=0){balance-=cost; totalBets+=cost;}
  else freeSpins--;

  grid.flat().forEach(s=>s.classList.add('spin-anim'));
  playSound('https://freesound.org/data/previews/414/414209_5121236-lq.mp3');
  vibrate(100);

  setTimeout(()=>{
    grid.flat().forEach(s=>s.classList.remove('spin-anim'));
    let matrix=[[],[],[]];
    let scatters=0;

    for(let r=0;r<3;r++){
      for(let c=0;c<5;c++){
        let sym=randSymbol();
        matrix[r][c]=sym;
        grid[r][c].textContent=sym.s;
        if(sym.scatter) scatters++;
      }
    }

    let totalWin=0;
    lines.forEach(line=>{
      let first=matrix[line[0][0]][line[0][1]];
      let count=1;
      for(let i=1;i<line.length;i++){
        let cur=matrix[line[i][0]][line[i][1]];
        if(cur.s===first.s || cur.wild) count++;
        else break;
      }
      if(count>=3 && !first.scatter){
        totalWin+=first.pay[count]||0;
      }
    });

    if(scatters>=3){
      freeSpins+=5;
      resultEl.textContent='‚≠ê SCATTER! +5 FS';
      playSound('https://freesound.org/data/previews/400/400292_5121236-lq.mp3');
      vibrate(200);
      triggerBonus();
    } else if(totalWin>0){
      balance+=totalWin; totalWins+=totalWin;
      resultEl.textContent='üéâ –í—ã–∏–≥—Ä—ã—à: '+totalWin;
      playSound('https://freesound.org/data/previews/235/235968_3981044-lq.mp3');
      vibrate(200);
    } else if(freeSpins<=0) resultEl.textContent='üòû –ü—Ä–æ–∏–≥—Ä—ã—à';

    balanceEl.textContent=balance;
    updateHistory(totalWin);
  },600);
}

// ===== –ò—Å—Ç–æ—Ä–∏—è + RTP =====
function updateHistory(win){
  history.unshift(win);
  if(history.length>20) history.pop();
  let sumBets=totalBets||1;
  let rtp=Math.round((totalWins/sumBets)*100);
  historyEl.innerHTML='–ò—Å—Ç–æ—Ä–∏—è: '+history.join(', ')+'<br>RTP: '+rtp+'%';
}

// ===== –ë–æ–Ω—É—Å–Ω–∞—è –∏–≥—Ä–∞ =====
function triggerBonus(){
  bonusEl.innerHTML='<h3>üéÅ –í—ã–±–µ—Ä–∏ —Å—É–Ω–¥—É–∫</h3>';
  for(let i=0;i<3;i++){
    let chest=document.createElement('div');
    chest.className='chest';
    chest.textContent='üéÅ';
    chest.onclick=function(){
      let reward=[50,100,200][i];
      balance+=reward; totalWins+=reward;
      resultEl.textContent='üéâ –ë–æ–Ω—É—Å: '+reward;
      bonusEl.innerHTML='';
      balanceEl.textContent=balance;
      playSound('https://freesound.org/data/previews/331/331912_5121236-lq.mp3');
      vibrate(300);
    };
    bonusEl.appendChild(chest);
  }
}

// ===== Telegram WebApp API =====
if(window.Telegram.WebApp){
  const tg=window.Telegram.WebApp;
  tg.expand();
  tg.MainButton.setText("BACK");
  tg.MainButton.onClick(()=>tg.close());
  vibrate(100);
}

</script>
</body>
</html>































































































































































































